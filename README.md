# XTrees

XTrees is a Python library for explainability of tree-based models.

## Features

- **Simplification of Random Forest:** Based on [Omer Sagi paper](https://www.sciencedirect.com/science/article/pii/S1566253519307869?via%3Dihub), this library provides an implementation for simply a Random Forest into a single "Forest Based Tree".

- **Visualization:** A visualization framework for binary trees based using SankeyPlot.

- **Dashboard:** Iteractive dashboards for model evaluation and explration.

![Combined dashboard](./reports/combined_dash.png?raw=true)

## Usage

**Simplifying a Random Forest**
```python
rf = RandomForestRegressor(n_estimators=20, max_depth=4)
rf.fit(X_train, y_train)

minimal_forest_size=10
max_number_of_branches=50
exclusion_threshold=0.8

fbt = ForestBasedTree(random_state=seed)

fbt.fit(rf, X_train, y_train, feature_types, feature_names, 
        minimal_forest_size=minimal_forest_size, amount_of_branches_threshold=max_number_of_branches, exclusion_threshold=exclusion_threshold)
```

**Creating dashboard**
```python
fbt_viz = VizTree(fbt, X)

dash = CombinedDashboard(fbt_viz, X_test, y_test, X, rf)
combined_dashboard.run(port=8065)
```

## Content

### Notebooks

- [all-together.ipynb](./all-together.ipynb): A full demonstration of the tool.

- [experiment_reg.ipynb](./experiment_reg.ipynb) and [experiment_class.ipynb](./experiment_class.ipynb): Experiment with FBT model

- [evaluate.ipynb](./evaluate.ipynb): Evaluate the results of experiment

- [explain_sleep.ipynb](./explain_sleep.ipynb): Showcase in sleep health and lifestyle dataset

### Scripts
- [ExperimentSupervised.py](./src/experiments/ExperimentSupervised.py): A generalized class for experimenting with any supervised machine learning model using synthetic datasets generated by `make_classification` and `make_regression` functions of `sklearn` library.


# License
This project is under MIT License.